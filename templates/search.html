{% extends 'base.html' %}


{% load static %}


{% block meta %}
<!-- cdn読み込みエラー回避のためにcacheを保存しない -->
<meta http-equiv="pragma" content="no-cache">
<meta name="expires" content="0">
<meta http-equiv="cache-control" content="no-cache, no-store">
{% endblock meta %}


{% block js %}
<script src="{% static 'js/search.js' %}"></script>
{% endblock js %}


{% block header %}
<header class="w-full h-[70px] bg-white drop-shadow flex items-center justify-center relative">
  <div class="fixed top-5 left-2 sm:left-20 text-xl cursor-pointer"><a href="/one">ONE</a></div>
  {% include './components/search-form.html' with keyword=keyword %}
</header>
{% endblock header %}


{% block body %}
<div class="container mx-auto my-8">
  {% if not episodes %}
  <p class="text-center">一致する回はありません。</p>
  {% else %}
  {% for episode in episodes %}
  <div class="pb-4 mb-4 border-b">
    <div class="flex">
      {% if episode.spotify_id %}
      <iframe class="spotify-player" style="border-radius:12px"
        src="https://open.spotify.com/embed/episode/{{ episode.spotify_id }}?utm_source=generator&t=0" width="100%"
        height="152" frameBorder="0" allowfullscreen=""
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy">
      </iframe>
      {% else %}
      <img class="h-[152px] rounded-md" src="{{ episode.radio_id.image.url }}" alt="">
      <div class="flex items-center">
        <div class="ml-2">
          <p>{{ episode.radio_id.title }}#{{ episode.number }}</p>
          <p>{{ episode.air_date|date:"Y-m-d" }}</p>
        </div>
      </div>
      {% endif %}
    </div>
    <div class="mt-2">
      {% for word in episode.word_set.all %}
      <span class="word-badge inline-block bg-gray-400 px-2 py-1 rounded-xl text-white mb-1 cursor-pointer">
        {{ word.original_form }}
        {% if word.start_time %}
        ：<span class="start-time">{{ word.start_time }}</span>
        {% endif %}
      </span>
      {% endfor %}
    </div>
  </div>
  {% endfor %}
  {% endif %}
</div>
{% endblock body %}
